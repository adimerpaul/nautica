import{Q as d}from"./QTooltip.70dcb804.js";import{_ as b,O as c,P as g,Q as a,R as t,S as l,V as m,aE as h,aq as Q,aC as x,aB as p,T as u,U as w,aT as D,J as k,aD as V}from"./index.c18f0555.js";import{b as C,Q as v}from"./QTable.990698e7.js";import{e as y}from"./QChip.f6dc33b9.js";import{Q as E}from"./QSpace.515ff689.js";import{Q as S}from"./QForm.192faf2b.js";import{Q as I}from"./QPage.b28ed28e.js";import{C as N}from"./ClosePopup.6d3f3ffe.js";import"./QList.70dc23e3.js";import"./QMarkupTable.ef5155a8.js";import"./QSelect.d48ab1b1.js";import"./format.2cae61da.js";import"./use-fullscreen.f417e3ed.js";const T={name:"CategoriesIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"name",label:"Nombre",align:"left",field:e=>e.name}],loading:!1,categories:[],category:{name:""},categoriesDialog:!1,filter:""}},mounted(){this.getCategories()},methods:{categoriesSave(){this.loading=!0,this.category.id?this.$axios.put(`categories/${this.category.id}`,this.category).then(e=>{this.categoriesDialog=!1;const s=this.categories.findIndex(r=>r.id===this.category.id);this.categories.splice(s,1,e.data),this.$alert.success("Categor\xEDa actualizada correctamente")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("categories",this.category).then(e=>{this.categoriesDialog=!1,this.categories.unshift(e.data),this.$alert.success("Categor\xEDa agregada correctamente")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},categoriesDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar esta categor\xEDa?").onOk(()=>{this.loading=!0,this.$axios.delete(`categories/${e}`).then(s=>{const r=this.categories.findIndex(f=>f.id===e);this.categories.splice(r,1),this.$alert.success("Categor\xEDa eliminada correctamente")}).catch(s=>{this.$alert.error("No se puede eliminar el registro porque tiene registros dependientes asociados.")}).finally(()=>{this.loading=!1})})},categoriesEdit(e){this.categoriesDialog=!0,this.category={...e}},categoriesAdd(){this.categoriesDialog=!0,this.category={name:""}},getCategories(){this.loading=!0,this.$axios.get("categories").then(e=>{this.categories=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},q={class:"text-h6"},A={class:"row"},B={class:"col-12"};function P(e,s,r,f,o,n){return c(),g(I,{class:"bg-grey-3 q-pa-md"},{default:a(()=>[t(v,{rows:o.categories,columns:o.columns,title:"Categor\xEDas","rows-per-page-options":[0],"row-key":"id",dense:"",filter:o.filter,loading:o.loading},{"body-cell-option":a(i=>[t(C,{"auto-width":""},{default:a(()=>[t(l,{flat:"",dense:"",icon:"edit",onClick:_=>n.categoriesEdit(i.row)},{default:a(()=>[t(d,null,{default:a(()=>[m("Editar")]),_:1})]),_:2},1032,["onClick"]),t(l,{flat:"",dense:"",icon:"delete",onClick:_=>n.categoriesDelete(i.row.id)},{default:a(()=>[t(d,null,{default:a(()=>[m("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"body-cell-tipo":a(i=>[t(C,{"auto-width":""},{default:a(()=>[i.row.tipo==="CLIENTE"?(c(),g(y,{key:0,"text-color":"white",label:"Cliente",color:"green"})):(c(),g(y,{key:1,"text-color":"white",label:"Proveedor",color:"indigo"}))]),_:2},1024)]),"top-right":a(()=>[t(l,{outline:"",dense:"",icon:"add_circle",onClick:n.categoriesAdd,label:"Agregar","no-caps":"",loading:o.loading},{default:a(()=>[t(d,null,{default:a(()=>[m("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),t(h,{modelValue:o.filter,"onUpdate:modelValue":s[0]||(s[0]=i=>o.filter=i),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:""},{append:a(()=>[t(Q,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),t(V,{modelValue:o.categoriesDialog,"onUpdate:modelValue":s[3]||(s[3]=i=>o.categoriesDialog=i),persistent:""},{default:a(()=>[t(x,{style:{width:"250px","max-width":"90vw"}},{default:a(()=>[t(p,{class:"row items-center q-pb-none"},{default:a(()=>[u("div",q,w(o.category.id?"Editar":"Agregar")+" Categor\xEDa",1),t(E),t(l,{flat:"",dense:"",icon:"close",onClick:s[1]||(s[1]=i=>o.categoriesDialog=!1)})]),_:1}),t(S,{onSubmit:n.categoriesSave},{default:a(()=>[t(p,null,{default:a(()=>[u("div",A,[u("div",B,[t(h,{modelValue:o.category.name,"onUpdate:modelValue":s[2]||(s[2]=i=>o.category.name=i),label:"Nombre",outlined:"",dense:"",rules:[i=>!!i||"Campo requerido"]},null,8,["modelValue","rules"])])])]),_:1}),t(D,{align:"right"},{default:a(()=>[k(t(l,{flat:"",label:"Cancelar",loading:o.loading},null,8,["loading"]),[[N]]),t(l,{color:"primary",label:"Guardar",type:"submit",loading:o.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var W=b(T,[["render",P]]);export{W as default};
