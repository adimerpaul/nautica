import{Q as u}from"./QTooltip.3d730680.js";import{_ as Q,Q as m,R as f,S as t,T as o,U as r,X as p,b6 as v,aE as _,an as y,aC as V,aB as C,V as n,W as D,aF as k,L as A,aG as S}from"./index.550f8220.js";import{Q as w,a as I,C as T}from"./ClosePopup.719e01db.js";import{f as g}from"./format.2611cbf2.js";import{Q as B,a as x}from"./QSpace.c62f1999.js";import{Q as E}from"./QForm.333f00b2.js";import{Q as N}from"./QPage.0216952a.js";import"./position-engine.6df5169d.js";const q={name:"BoatsIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"name",label:"Nombre",align:"left",field:e=>e.name},{name:"role",label:"Rol",align:"left",field:e=>e.role},{name:"boat",label:"Barco",align:"left",field:e=>{var a;return(a=e.boat)==null?void 0:a.name}}],loading:!1,crews:[],crew:{},crewDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1,boats:[]}},mounted(){this.crewGet(),this.boatsGet()},methods:{boatsGet(){this.$axios.get("boats").then(e=>{this.boats=e.data})},crewSave(){this.loading=!0,this.crew.id?this.$axios.put(`crews/${this.crew.id}`,this.crew).then(e=>{this.crewDialog=!1;const a=this.crews.findIndex(s=>s.id===this.crew.id);this.crews.splice(a,1,e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("crews",this.crew).then(e=>{this.crewDialog=!1,this.crews.unshift(e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},crewDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este crewe?").onOk(()=>{this.loading=!0,this.$axios.delete(`crews/${e.id}`).then(a=>{const s=this.crews.findIndex(h=>h.id===a.data.id);console.log(s),s!==-1&&this.crews.splice(s,1)}).catch(a=>{this.$alert.error(a.response.data.message)}).finally(()=>{this.loading=!1})})},crewEdit(e){this.crewDialog=!0,this.crew={...e}},crewAdd(){this.crewDialog=!0,this.crew={name:""}},crewGet(){this.loading=!0,this.$axios.get("crews").then(e=>{this.crews=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},G={class:"text-h6"},U={class:"row"},R={class:"col-12"},P={class:"col-12"},O={class:"col-12"};function F(e,a,s,h,i,d){return m(),f(N,{class:"bg-grey-3 q-pa-md"},{default:t(()=>[o(I,{rows:i.crews,columns:i.columns,title:"Tripulantes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:i.filter,loading:i.loading},{"body-cell-option":t(l=>[o(w,{"auto-width":""},{default:t(()=>[o(r,{flat:"",dense:"",icon:"edit",onClick:c=>d.crewEdit(l.row)},{default:t(()=>[o(u,null,{default:t(()=>[p("Editar")]),_:1})]),_:2},1032,["onClick"]),o(r,{flat:"",dense:"",icon:"delete",onClick:c=>d.crewDelete(l.row)},{default:t(()=>[o(u,null,{default:t(()=>[p("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"body-cell-boat":t(l=>[o(w,{props:l},{default:t(()=>{var c,b;return[o(g,{label:(c=l.row.boat)==null?void 0:c.name,"text-color":"white",style:v({backgroundColor:(b=l.row.boat)==null?void 0:b.color}),icon:"directions_boat"},null,8,["label","style"])]}),_:2},1032,["props"])]),"body-cell-role":t(l=>[o(w,{props:l},{default:t(()=>[l.row.role==="CAPITAN"?(m(),f(g,{key:0,label:"Capitan","text-color":"white",dense:"",icon:"person",color:"primary"})):(m(),f(g,{key:1,label:"Tripulante","text-color":"white",dense:"",icon:"person",color:"indigo"}))]),_:2},1032,["props"])]),"top-right":t(()=>[o(r,{outline:"",dense:"",icon:"add_circle",onClick:d.crewAdd,label:"Agregar","no-caps":"",loading:i.loading},{default:t(()=>[o(u,null,{default:t(()=>[p("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),o(_,{modelValue:i.filter,"onUpdate:modelValue":a[0]||(a[0]=l=>i.filter=l),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:"",clearable:""},{append:t(()=>[o(y,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),o(S,{modelValue:i.crewDialog,"onUpdate:modelValue":a[5]||(a[5]=l=>i.crewDialog=l),persistent:""},{default:t(()=>[o(V,{style:{width:"250px","max-width":"90vw"}},{default:t(()=>[o(C,{class:"row items-center q-pb-none"},{default:t(()=>[n("div",G,D(i.crew.id?"Editar":"Agregar")+" Tripulantes",1),o(B),o(r,{flat:"",dense:"",icon:"close",onClick:a[1]||(a[1]=l=>i.crewDialog=!1)})]),_:1}),o(E,{onSubmit:d.crewSave},{default:t(()=>[o(C,null,{default:t(()=>[n("div",U,[n("div",R,[o(_,{modelValue:i.crew.name,"onUpdate:modelValue":a[2]||(a[2]=l=>i.crew.name=l),label:"Nombre",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",P,[o(x,{modelValue:i.crew.role,"onUpdate:modelValue":a[3]||(a[3]=l=>i.crew.role=l),options:[{label:"Capit\xE1n",value:"CAPITAN"},{label:"Marinero",value:"MARINERO"}],label:"Rol",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"],"value-field":"value","label-field":"label","map-options":"","emit-value":""},null,8,["modelValue","rules"])]),n("div",O,[o(x,{modelValue:i.crew.boat_id,"onUpdate:modelValue":a[4]||(a[4]=l=>i.crew.boat_id=l),options:i.boats,label:"Barco",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"],"emit-value":"","map-options":"","option-value":"id","option-label":"name"},null,8,["modelValue","options","rules"])])])]),_:1}),o(k,{align:"right"},{default:t(()=>[A(o(r,{flat:"",label:"Cancelar",loading:i.loading},null,8,["loading"]),[[T]]),o(r,{color:"primary",label:"Guardar",type:"submit",loading:i.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var K=Q(q,[["render",F]]);export{K as default};
