import{Q as u}from"./QTooltip.6c666962.js";import{_ as V,Q as m,R as p,S as n,T as i,U as a,X as f,aE as r,ar as Q,aC as v,aB as h,V as s,W as y,aT as x,L as D,aD as w}from"./index.d0cdc383.js";import{b as C,Q as E}from"./QTable.47cbe813.js";import{e as b}from"./QChip.dfad0562.js";import{Q as k}from"./QSpace.a0dd195b.js";import{Q as T}from"./QSelect.0793eb75.js";import{Q as I}from"./QForm.54665059.js";import{Q as U}from"./QPage.ef29aaa2.js";import{C as q}from"./ClosePopup.bf2a9e3b.js";import"./QList.53b2dad9.js";import"./QMarkupTable.8263b7a1.js";import"./use-fullscreen.33ab63bc.js";import"./format.2cae61da.js";const S={name:"ClientsIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"name",label:"Nombre",align:"left",field:e=>e.name},{name:"company",label:"Empresa",align:"left",field:e=>e.company},{name:"nit",label:"DUI",align:"left",field:e=>e.nit},{name:"phone",label:"Tel\xE9fono",align:"left",field:e=>e.phone},{name:"tipo",label:"Tipo",align:"left",field:e=>e.tipo}],loading:!1,clients:[],client:{},clientDialog:!1,clienDialogHistory:!1,filter:""}},mounted(){this.getClients()},methods:{clientSave(){this.loading=!0,this.client.id?this.$axios.put(`clients/${this.client.id}`,this.client).then(e=>{this.clientDialog=!1;const o=this.clients.findIndex(d=>d.id===this.client.id);this.clients.splice(o,1,e.data),this.$alert.success("Cliente actualizado correctamente")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("clients",this.client).then(e=>{this.clientDialog=!1,this.clients.unshift(e.data),this.$alert.success("Cliente agregado correctamente")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},clientDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este cliente?").onOk(()=>{this.loading=!0,this.$axios.delete(`clients/${e}`).then(o=>{const d=this.clients.findIndex(g=>g.id===e);this.clients.splice(d,1),this.$alert.success("Cliente eliminado correctamente")}).catch(o=>{this.$alert.error("No se puede eliminar el registro porque tiene registros dependientes asociados.")}).finally(()=>{this.loading=!1})})},clientHistory(e){this.clienDialogHistory=!0,this.client={...e}},clientEdit(e){this.clientDialog=!0,this.client={...e}},clientAdd(){this.clientDialog=!0,this.client={name:"",ci:""}},getClients(){this.loading=!0,this.$axios.get("clients").then(e=>{this.clients=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},N={class:"text-h6"},A={class:"row"},B={class:"col-12"},P=s("div",{class:"col-12"},null,-1),O={class:"col-12"},H={class:"col-12"},L={class:"col-12"},R={class:"col-12"};function z(e,o,d,g,t,c){return m(),p(U,{class:"bg-grey-3 q-pa-md"},{default:n(()=>[i(E,{rows:t.clients,columns:t.columns,title:"Clientes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:t.filter,loading:t.loading},{"body-cell-option":n(l=>[i(C,{"auto-width":""},{default:n(()=>[i(a,{flat:"",dense:"",icon:"edit",onClick:_=>c.clientEdit(l.row)},{default:n(()=>[i(u,null,{default:n(()=>[f("Editar")]),_:1})]),_:2},1032,["onClick"]),i(a,{flat:"",dense:"",icon:"delete",onClick:_=>c.clientDelete(l.row.id)},{default:n(()=>[i(u,null,{default:n(()=>[f("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"body-cell-tipo":n(l=>[i(C,{"auto-width":""},{default:n(()=>[l.row.tipo==="CLIENTE"?(m(),p(b,{key:0,"text-color":"white",label:"Cliente",color:"green"})):(m(),p(b,{key:1,"text-color":"white",label:"Proveedor",color:"indigo"}))]),_:2},1024)]),"top-right":n(()=>[i(a,{outline:"",dense:"",icon:"add_circle",onClick:c.clientAdd,label:"Agregar","no-caps":"",loading:t.loading},{default:n(()=>[i(u,null,{default:n(()=>[f("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),i(r,{modelValue:t.filter,"onUpdate:modelValue":o[0]||(o[0]=l=>t.filter=l),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:""},{append:n(()=>[i(Q,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),i(w,{modelValue:t.clientDialog,"onUpdate:modelValue":o[7]||(o[7]=l=>t.clientDialog=l),persistent:""},{default:n(()=>[i(v,{style:{width:"250px","max-width":"90vw"}},{default:n(()=>[i(h,{class:"row items-center q-pb-none"},{default:n(()=>[s("div",N,y(t.client.id?"Editar":"Agregar")+" Cliente",1),i(k),i(a,{flat:"",dense:"",icon:"close",onClick:o[1]||(o[1]=l=>t.clientDialog=!1)})]),_:1}),i(I,{onSubmit:c.clientSave},{default:n(()=>[i(h,null,{default:n(()=>[s("div",A,[s("div",B,[i(r,{modelValue:t.client.name,"onUpdate:modelValue":o[2]||(o[2]=l=>t.client.name=l),label:"Nombre",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),P,s("div",O,[i(r,{modelValue:t.client.company,"onUpdate:modelValue":o[3]||(o[3]=l=>t.client.company=l),label:"Empresa",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",H,[i(r,{modelValue:t.client.nit,"onUpdate:modelValue":o[4]||(o[4]=l=>t.client.nit=l),label:"DUI",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",L,[i(r,{modelValue:t.client.phone,"onUpdate:modelValue":o[5]||(o[5]=l=>t.client.phone=l),label:"Tel\xE9fono",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",R,[i(T,{modelValue:t.client.tipo,"onUpdate:modelValue":o[6]||(o[6]=l=>t.client.tipo=l),label:"Tipo",outlined:"",dense:"",options:[{label:"Cliente",value:"CLIENTE"},{label:"Proveedor",value:"PROVEEDOR"}],rules:[l=>!!l||"Campo requerido"],"emit-value":"","map-options":""},null,8,["modelValue","rules"])])])]),_:1}),i(x,{align:"right"},{default:n(()=>[D(i(a,{flat:"",label:"Cancelar",loading:t.loading},null,8,["loading"]),[[q]]),i(a,{color:"primary",label:"Guardar",type:"submit",loading:t.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var ie=V(S,[["render",z]]);export{ie as default};
