import{Q as d}from"./QTooltip.9cb42153.js";import{_ as b,Q as c,R as g,S as a,T as t,U as l,X as m,aE as h,ar as Q,aC as x,aB as p,V as u,W as w,aT as D,L as k,aD as V}from"./index.15f37353.js";import{b as C,Q as v}from"./QTable.41130bbf.js";import{e as y}from"./QChip.b1ed6ce6.js";import{Q as E}from"./QSpace.441e63e5.js";import{Q as S}from"./QForm.bf64e4fc.js";import{Q as I}from"./QPage.bbad0bcd.js";import{C as N}from"./ClosePopup.455cf86d.js";import"./QList.d250bc0b.js";import"./QMarkupTable.284b9878.js";import"./QSelect.a4c6e2af.js";import"./format.2cae61da.js";import"./use-fullscreen.c6dd7caa.js";const T={name:"CategoriesIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"name",label:"Nombre",align:"left",field:e=>e.name}],loading:!1,categories:[],category:{name:""},categoriesDialog:!1,filter:""}},mounted(){this.getCategories()},methods:{categoriesSave(){this.loading=!0,this.category.id?this.$axios.put(`categories/${this.category.id}`,this.category).then(e=>{this.categoriesDialog=!1;const s=this.categories.findIndex(r=>r.id===this.category.id);this.categories.splice(s,1,e.data),this.$alert.success("Categor\xEDa actualizada correctamente")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("categories",this.category).then(e=>{this.categoriesDialog=!1,this.categories.unshift(e.data),this.$alert.success("Categor\xEDa agregada correctamente")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},categoriesDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar esta categor\xEDa?").onOk(()=>{this.loading=!0,this.$axios.delete(`categories/${e}`).then(s=>{const r=this.categories.findIndex(f=>f.id===e);this.categories.splice(r,1),this.$alert.success("Categor\xEDa eliminada correctamente")}).catch(s=>{this.$alert.error("No se puede eliminar el registro porque tiene registros dependientes asociados.")}).finally(()=>{this.loading=!1})})},categoriesEdit(e){this.categoriesDialog=!0,this.category={...e}},categoriesAdd(){this.categoriesDialog=!0,this.category={name:""}},getCategories(){this.loading=!0,this.$axios.get("categories").then(e=>{this.categories=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},A={class:"text-h6"},B={class:"row"},q={class:"col-12"};function U(e,s,r,f,o,n){return c(),g(I,{class:"bg-grey-3 q-pa-md"},{default:a(()=>[t(v,{rows:o.categories,columns:o.columns,title:"Categor\xEDas","rows-per-page-options":[0],"row-key":"id",dense:"",filter:o.filter,loading:o.loading},{"body-cell-option":a(i=>[t(C,{"auto-width":""},{default:a(()=>[t(l,{flat:"",dense:"",icon:"edit",onClick:_=>n.categoriesEdit(i.row)},{default:a(()=>[t(d,null,{default:a(()=>[m("Editar")]),_:1})]),_:2},1032,["onClick"]),t(l,{flat:"",dense:"",icon:"delete",onClick:_=>n.categoriesDelete(i.row.id)},{default:a(()=>[t(d,null,{default:a(()=>[m("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"body-cell-tipo":a(i=>[t(C,{"auto-width":""},{default:a(()=>[i.row.tipo==="CLIENTE"?(c(),g(y,{key:0,"text-color":"white",label:"Cliente",color:"green"})):(c(),g(y,{key:1,"text-color":"white",label:"Proveedor",color:"indigo"}))]),_:2},1024)]),"top-right":a(()=>[t(l,{outline:"",dense:"",icon:"add_circle",onClick:n.categoriesAdd,label:"Agregar","no-caps":"",loading:o.loading},{default:a(()=>[t(d,null,{default:a(()=>[m("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),t(h,{modelValue:o.filter,"onUpdate:modelValue":s[0]||(s[0]=i=>o.filter=i),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:""},{append:a(()=>[t(Q,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),t(V,{modelValue:o.categoriesDialog,"onUpdate:modelValue":s[3]||(s[3]=i=>o.categoriesDialog=i),persistent:""},{default:a(()=>[t(x,{style:{width:"250px","max-width":"90vw"}},{default:a(()=>[t(p,{class:"row items-center q-pb-none"},{default:a(()=>[u("div",A,w(o.category.id?"Editar":"Agregar")+" Categor\xEDa",1),t(E),t(l,{flat:"",dense:"",icon:"close",onClick:s[1]||(s[1]=i=>o.categoriesDialog=!1)})]),_:1}),t(S,{onSubmit:n.categoriesSave},{default:a(()=>[t(p,null,{default:a(()=>[u("div",B,[u("div",q,[t(h,{modelValue:o.category.name,"onUpdate:modelValue":s[2]||(s[2]=i=>o.category.name=i),label:"Nombre",outlined:"",dense:"",rules:[i=>!!i||"Campo requerido"]},null,8,["modelValue","rules"])])])]),_:1}),t(D,{align:"right"},{default:a(()=>[k(t(l,{flat:"",label:"Cancelar",loading:o.loading},null,8,["loading"]),[[N]]),t(l,{color:"primary",label:"Guardar",type:"submit",loading:o.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var K=b(T,[["render",U]]);export{K as default};
