import{_ as D,Q as u,R as b,S as o,T as e,L as p,ar as f,X as m,b9 as Q,V as n,U as h,aE as x,aC as S,aB as k,W as V,aT as B,aD as E,a3 as g}from"./index.abfdc3b2.js";import{a as _,b as c,e as v}from"./QChip.1687f1b4.js";import{Q as I}from"./QBtnDropdown.01843d24.js";import{b as w,Q as A}from"./QTable.0ac775ec.js";import{Q as T}from"./QTooltip.ce72369c.js";import{Q as q}from"./QSpace.94ffd6db.js";import{Q as G}from"./QSelect.59c01bbe.js";import{Q as N}from"./QForm.cfca3500.js";import{Q as U}from"./QPage.ddf71f8f.js";import{C as R}from"./ClosePopup.fc90dd23.js";import"./QList.50a08c0c.js";import"./QMarkupTable.11bc8ee8.js";import"./use-fullscreen.2d871973.js";import"./format.2cae61da.js";const z={name:"BoatsIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:a=>a.option},{name:"id",label:"ID",align:"left",field:a=>a.id},{name:"name",label:"Nombre",align:"left",field:a=>a.name},{name:"company",label:"Empresa",align:"left",field:a=>{var l;return(l=a.company)==null?void 0:l.name}}],loading:!1,boats:[],boat:{},boatDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1,companies:[]}},mounted(){this.boatGet(),this.companiesGet()},methods:{boatShowClick(a,l){this.$router.push("boatdetails/"+l.id)},boatShow(a){this.$router.push("boatdetails/"+a.id)},companiesGet(){this.$axios.get("companies").then(a=>{this.companies=a.data})},boatSave(){this.loading=!0,this.boat.id?this.$axios.put(`boats/${this.boat.id}`,this.boat).then(a=>{this.boatDialog=!1;const l=this.boats.findIndex(r=>r.id===this.boat.id);this.boats.splice(l,1,a.data),this.$alert.success("Bote actualizado correctamente")}).catch(a=>{this.$alert.error(a.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("boats",this.boat).then(a=>{this.boatDialog=!1,this.boats.unshift(a.data),this.$alert.success("Bote agregado correctamente")}).catch(a=>{this.$alert.error(a.response.data.message)}).finally(()=>{this.loading=!1})},boatDelete(a){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este boate?").onOk(()=>{this.loading=!0,this.$axios.delete(`boats/${a.id}`).then(l=>{const r=this.boats.findIndex(y=>y.id===l.data.id);console.log(r),r!==-1&&this.boats.splice(r,1),this.$alert.success("Bote eliminado correctamente")}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})})},boatEdit(a){this.boatDialog=!0,this.boat={...a}},boatAdd(){this.boatDialog=!0,this.boat={name:""}},boatGet(){this.loading=!0,this.$axios.get("boats").then(a=>{this.boats=a.data}).catch(a=>{this.$alert.error(a.response.data.message)}).finally(()=>{this.loading=!1})}}},O={class:"row"},P={class:"col-4 flex flex-center"},j={class:"col-8"},F={class:"text-h6"},H={class:"row"},L={class:"col-12"},W={class:"col-12"};function X(a,l,r,y,i,d){return u(),b(U,{class:"bg-grey-3 q-pa-md"},{default:o(()=>[e(A,{rows:i.boats,columns:i.columns,title:"Botes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:i.filter,loading:i.loading,onRowClick:d.boatShowClick},{"body-cell-option":o(t=>[e(w,{"auto-width":""},{default:o(()=>[e(I,{label:"Opciones",color:"primary","auto-close":"","no-caps":"",size:"10px",onClick:l[0]||(l[0]=s=>{s.stopPropagation()})},{default:o(()=>[p((u(),b(_,{clickable:"",onClick:s=>d.boatShow(t.row)},{default:o(()=>[e(c,{avatar:""},{default:o(()=>[e(f,{name:"attach_file"})]),_:1}),e(c,null,{default:o(()=>[m("Adjuntas")]),_:1})]),_:2},1032,["onClick"])),[[g]]),p((u(),b(_,{clickable:"",onClick:s=>d.boatEdit(t.row)},{default:o(()=>[e(c,{avatar:""},{default:o(()=>[e(f,{name:"edit"})]),_:1}),e(c,null,{default:o(()=>[m("Editar")]),_:1})]),_:2},1032,["onClick"])),[[g]]),p((u(),b(_,{clickable:"",onClick:s=>d.boatDelete(t.row)},{default:o(()=>[e(c,{avatar:""},{default:o(()=>[e(f,{name:"delete"})]),_:1}),e(c,null,{default:o(()=>[m("Eliminar")]),_:1})]),_:2},1032,["onClick"])),[[g]])]),_:2},1024)]),_:2},1024)]),"body-cell-name":o(t=>[e(w,{props:t},{default:o(()=>[e(v,{label:t.row.name,"text-color":"white",style:Q({backgroundColor:t.row.color}),icon:"directions_boat"},null,8,["label","style"])]),_:2},1032,["props"])]),"body-cell-company":o(t=>[e(w,{props:t},{default:o(()=>{var s,C;return[e(v,{label:(s=t.row.company)==null?void 0:s.name,"text-color":"white",dense:"",style:Q({backgroundColor:(C=t.row.company)==null?void 0:C.color}),icon:"business"},null,8,["label","style"])]}),_:2},1032,["props"])]),"top-right":o(()=>[n("div",O,[n("div",P,[e(h,{outline:"",dense:"",icon:"add_circle",onClick:d.boatAdd,label:"Agregar","no-caps":"",loading:i.loading,class:"full-width"},{default:o(()=>[e(T,null,{default:o(()=>[m("Agregar")]),_:1})]),_:1},8,["onClick","loading"])]),n("div",j,[e(x,{modelValue:i.filter,"onUpdate:modelValue":l[1]||(l[1]=t=>i.filter=t),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:"",clearable:""},{append:o(()=>[e(f,{name:"search"})]),_:1},8,["modelValue"])])])]),default:o(()=>[m(" > ")]),_:1},8,["rows","columns","filter","loading","onRowClick"]),e(E,{modelValue:i.boatDialog,"onUpdate:modelValue":l[5]||(l[5]=t=>i.boatDialog=t),persistent:""},{default:o(()=>[e(S,{style:{width:"250px","max-width":"90vw"}},{default:o(()=>[e(k,{class:"row items-center q-pb-none"},{default:o(()=>[n("div",F,V(i.boat.id?"Editar":"Agregar")+" Botes",1),e(q),e(h,{flat:"",dense:"",icon:"close",onClick:l[2]||(l[2]=t=>i.boatDialog=!1)})]),_:1}),e(N,{onSubmit:d.boatSave},{default:o(()=>[e(k,null,{default:o(()=>[n("div",H,[n("div",L,[e(x,{modelValue:i.boat.name,"onUpdate:modelValue":l[3]||(l[3]=t=>i.boat.name=t),label:"Nombre",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",W,[e(G,{modelValue:i.boat.company_id,"onUpdate:modelValue":l[4]||(l[4]=t=>i.boat.company_id=t),options:i.companies,label:"Empresa",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"],"emit-value":"","map-options":"","option-value":"id","option-label":"name"},null,8,["modelValue","options","rules"])])])]),_:1}),e(B,{align:"right"},{default:o(()=>[p(e(h,{flat:"",label:"Cancelar",loading:i.loading},null,8,["loading"]),[[R]]),e(h,{color:"primary",label:"Guardar",type:"submit",loading:i.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var re=D(z,[["render",X]]);export{re as default};
