import{_ as D,Q as u,R as x,S as d,V as e,T as l,aB as h,W as r,U as m,Y as f,Z as C,$ as V,aC as b,aE as v,aT as F,aD as Q,a4 as k}from"./index.15f37353.js";import{Q as w}from"./QMarkupTable.284b9878.js";import{Q as U}from"./QSelect.a4c6e2af.js";import{Q as B}from"./QForm.bf64e4fc.js";import{Q as Y}from"./QPage.bbad0bcd.js";import{h as y}from"./moment.40bc58bf.js";import"./QChip.b1ed6ce6.js";import"./format.2cae61da.js";const A={name:"BoatDetails",data(){return{boat:{},file:{},dialog:!1,imageUrl:null,loading:!1}},async created(){this.boatGet()},methods:{onFileChange(t){const a=t.target.files[0];this.imageUrl=a},boatGet(){this.$axios.get(`boats/${this.$route.params.id}`).then(t=>{this.boat=t.data})},storeFile(){if(!this.imageUrl)return this.$alert.error("Archivo es requerido"),!1;const t=new FormData;t.append("documento",this.file.documento),t.append("anio",this.file.anio),t.append("fecha_vencimiento",this.file.fecha_vencimiento),t.append("archivo",this.imageUrl),this.loading=!0,this.$axios.post(`boatsFile2/${this.boat.id}`,t).then(a=>{this.boat=a.data,this.dialog=!1,this.boatGet()}).finally(()=>{this.loading=!1})},fileUpload(t){t.target&&t.target.files&&t.target.files.length>0?this.file.archivo=t.target.files[0]:console.error("No se pudo cargar el archivo correctamente.")},createClick(){this.dialog=!0,this.imageUrl=null,this.file={documento:"",archivo:null,anio:y().format("YYYY"),fecha_vencimiento:y().format("YYYY-MM-DD")}},diffDays(t){if(!t)return"";const a=new Date(t)-new Date;return Math.ceil(a/(1e3*60*60*24))},updateBoat(){this.$axios.put(`boats/${this.boat.id}`,this.boat).then(t=>{this.boat=t.data})},uploadBoat(t,a){this.file=a.target.files[0];const c=new FormData;c.append("file",this.file),c.append("field",t),this.$axios.post(`boatsFile/${this.boat.id}`,c).then(p=>{this.boat=p.data})}}},q={class:"row"},S={class:"col-12"},T=e("div",{class:"text-caption"},"Nombre",-1),G={class:"text-subtitle1"},M={class:"row"},N={class:"col-12 col-md-4"},E=e("div",{class:"text-caption"},"Empresa",-1),I={class:"text-subtitle1"},L={class:"col-12 col-md-4"},z=e("div",{class:"text-caption"},"Direcci\xF3n",-1),P={class:"text-subtitle1"},R={class:"col-12 col-md-4"},W=e("div",{class:"text-caption"},"Tel\xE9fono Compania",-1),Z={class:"text-subtitle1"},j={class:"col-12 text-right q-pa-xs"},H={class:"col-12"},J=e("thead",null,[e("tr",{class:"bg-primary text-white"},[e("th",null,"Documento"),e("th",null,"Archivo"),e("th",null,"A\xF1o"),e("th",null,"Fecha de vencimiento"),e("th",null,"Dias para vecimiento")])],-1),K={key:1,class:"text-negative"};function O(t,a,c,p,i,n){return u(),x(Y,{class:"q-pa-xs bg-grey-3"},{default:d(()=>[e("div",q,[e("div",S,[l(b,null,{default:d(()=>[l(h,{class:"q-pa-md bg-primary text-white"},{default:d(()=>[T,e("div",G,r(i.boat.name),1)]),_:1}),l(h,{class:"q-pa-xs"},{default:d(()=>{var o,_,g;return[e("div",M,[e("div",N,[E,e("div",I,r((o=i.boat.company)==null?void 0:o.name),1)]),e("div",L,[z,e("div",P,r((_=i.boat.company)==null?void 0:_.address),1)]),e("div",R,[W,e("div",Z,r((g=i.boat.company)==null?void 0:g.phone),1)]),e("div",j,[l(m,{icon:"add_circle",label:"Agregar Documento",color:"green",onClick:n.createClick,"no-caps":""},null,8,["onClick"])]),e("div",H,[l(w,{dense:"","wrap-cells":""},{default:d(()=>[J,e("tbody",null,[(u(!0),f(V,null,C(i.boat.files,s=>(u(),f("tr",{key:s.id},[e("td",null,r(s.documento),1),e("td",null,[l(m,{icon:"visibility",dense:"",flat:"",href:t.$url+"../files/"+s.archivo,type:"a",target:"_blank"},null,8,["href"])]),e("td",null,r(s.anio),1),e("td",null,r(s.fecha),1),e("td",null,[n.diffDays(s.fecha_vencimiento)>0?(u(),f("span",{key:0,class:k({"text-positive":n.diffDays(s.fecha_vencimiento)>60,"text-warning":n.diffDays(s.fecha_vencimiento)<=60&&n.diffDays(s.fecha_vencimiento)>30,"text-negative":n.diffDays(s.fecha_vencimiento)<=30})},r(n.diffDays(s.fecha_vencimiento)),3)):(u(),f("span",K," Vencido "))])]))),128))])]),_:1})])])]}),_:1})]),_:1})])]),l(Q,{modelValue:i.dialog,"onUpdate:modelValue":a[5]||(a[5]=o=>i.dialog=o)},{default:d(()=>[l(b,null,{default:d(()=>[l(h,null,{default:d(()=>[l(B,{onSubmit:n.storeFile},{default:d(()=>[l(U,{modelValue:i.file.documento,"onUpdate:modelValue":a[0]||(a[0]=o=>i.file.documento=o),label:"Documento",outlined:"",dense:"",options:["DIF","Autoridad","Licencia"],rules:[o=>!!o||"Seleccione un documento"]},null,8,["modelValue","rules"]),l(v,{modelValue:i.file.anio,"onUpdate:modelValue":a[1]||(a[1]=o=>i.file.anio=o),label:"A\xF1o",outlined:"",dense:"",rules:[o=>!!o||"A\xF1o es requerido"]},null,8,["modelValue","rules"]),l(v,{modelValue:i.file.fecha_vencimiento,"onUpdate:modelValue":a[2]||(a[2]=o=>i.file.fecha_vencimiento=o),label:"Fecha de vencimiento",type:"date",outlined:"",dense:"",rules:[o=>!!o||"Fecha de vencimiento es requerido"]},null,8,["modelValue","rules"]),e("input",{type:"file",onChange:a[3]||(a[3]=(...o)=>n.onFileChange&&n.onFileChange(...o))},null,32),l(F,{align:"right"},{default:d(()=>[l(m,{label:"Cancelar",color:"negative",onClick:a[4]||(a[4]=o=>i.dialog=!1),loading:i.loading},null,8,["loading"]),l(m,{label:"Guardar",color:"primary",type:"submit",loading:i.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var se=D(A,[["render",O]]);export{se as default};
