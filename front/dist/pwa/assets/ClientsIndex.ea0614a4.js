import{Q as u}from"./QTooltip.8852e1b3.js";import{_ as h,Q as C,R as b,S as o,T as i,U as a,X as m,aE as d,an as V,aC as _,aB as p,V as s,W as Q,aF as x,L as y,aG as D}from"./index.ea69d991.js";import{Q as v,a as w,C as k}from"./ClosePopup.6edd962f.js";import{Q as E}from"./QSpace.f87c73ef.js";import{Q as I}from"./QForm.2a37e5e1.js";import{Q as T}from"./QPage.6495c621.js";import"./position-engine.299ce442.js";import"./QList.99f36a25.js";import"./QMarkupTable.d889b165.js";import"./use-fullscreen.b2b12d06.js";import"./QChip.54b0f243.js";import"./format.2cae61da.js";const q={name:"ClientsIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"name",label:"Nombre",align:"left",field:e=>e.name},{name:"lastname",label:"Apellido",align:"left",field:e=>e.lastname},{name:"company",label:"Empresa",align:"left",field:e=>e.company},{name:"nit",label:"NIT",align:"left",field:e=>e.nit},{name:"phone",label:"Tel\xE9fono",align:"left",field:e=>e.phone}],loading:!1,clients:[],client:{},clientDialog:!1,clienDialogHistory:!1,filter:""}},mounted(){this.getClients()},methods:{clientSave(){this.loading=!0,this.client.id?this.$axios.put(`clients/${this.client.id}`,this.client).then(e=>{this.clientDialog=!1;const n=this.clients.findIndex(r=>r.id===this.client.id);this.clients.splice(n,1,e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("clients",this.client).then(e=>{this.clientDialog=!1,this.clients.unshift(e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},clientDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este cliente?").onOk(()=>{this.loading=!0,this.$axios.delete(`clients/${e}`).then(n=>{const r=this.clients.findIndex(f=>f.id===e);this.clients.splice(r,1)}).catch(n=>{this.$alert.error(n.response.data.message)}).finally(()=>{this.loading=!1})})},clientHistory(e){this.clienDialogHistory=!0,this.client={...e}},clientEdit(e){this.clientDialog=!0,this.client={...e}},clientAdd(){this.clientDialog=!0,this.client={name:"",ci:""}},getClients(){this.loading=!0,this.$axios.get("clients").then(e=>{this.clients=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},A={class:"text-h6"},S={class:"row"},U={class:"col-12"},N={class:"col-12"},B={class:"col-12"},H={class:"col-12"},F={class:"col-12"};function G(e,n,r,f,t,c){return C(),b(T,{class:"bg-grey-3 q-pa-md"},{default:o(()=>[i(w,{rows:t.clients,columns:t.columns,title:"Clientes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:t.filter,loading:t.loading},{"body-cell-option":o(l=>[i(v,{"auto-width":""},{default:o(()=>[i(a,{flat:"",dense:"",icon:"edit",onClick:g=>c.clientEdit(l.row)},{default:o(()=>[i(u,null,{default:o(()=>[m("Editar")]),_:1})]),_:2},1032,["onClick"]),i(a,{flat:"",dense:"",icon:"delete",onClick:g=>c.clientDelete(l.row.id)},{default:o(()=>[i(u,null,{default:o(()=>[m("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"top-right":o(()=>[i(a,{outline:"",dense:"",icon:"add_circle",onClick:c.clientAdd,label:"Agregar","no-caps":"",loading:t.loading},{default:o(()=>[i(u,null,{default:o(()=>[m("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),i(d,{modelValue:t.filter,"onUpdate:modelValue":n[0]||(n[0]=l=>t.filter=l),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:""},{append:o(()=>[i(V,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),i(D,{modelValue:t.clientDialog,"onUpdate:modelValue":n[7]||(n[7]=l=>t.clientDialog=l),persistent:""},{default:o(()=>[i(_,{style:{width:"250px","max-width":"90vw"}},{default:o(()=>[i(p,{class:"row items-center q-pb-none"},{default:o(()=>[s("div",A,Q(t.client.id?"Editar":"Agregar")+" Cliente",1),i(E),i(a,{flat:"",dense:"",icon:"close",onClick:n[1]||(n[1]=l=>t.clientDialog=!1)})]),_:1}),i(I,{onSubmit:c.clientSave},{default:o(()=>[i(p,null,{default:o(()=>[s("div",S,[s("div",U,[i(d,{modelValue:t.client.name,"onUpdate:modelValue":n[2]||(n[2]=l=>t.client.name=l),label:"Nombre",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",N,[i(d,{modelValue:t.client.lastname,"onUpdate:modelValue":n[3]||(n[3]=l=>t.client.lastname=l),label:"Apellido",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",B,[i(d,{modelValue:t.client.company,"onUpdate:modelValue":n[4]||(n[4]=l=>t.client.company=l),label:"Empresa",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",H,[i(d,{modelValue:t.client.nit,"onUpdate:modelValue":n[5]||(n[5]=l=>t.client.nit=l),label:"NIT",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),s("div",F,[i(d,{modelValue:t.client.phone,"onUpdate:modelValue":n[6]||(n[6]=l=>t.client.phone=l),label:"Tel\xE9fono",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])])])]),_:1}),i(x,{align:"right"},{default:o(()=>[y(i(a,{flat:"",label:"Cancelar",loading:t.loading},null,8,["loading"]),[[k]]),i(a,{color:"primary",label:"Guardar",type:"submit",loading:t.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Z=h(q,[["render",G]]);export{Z as default};
